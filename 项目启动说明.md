# 宠物网项目 - 快速启动指南

## 🚀 一键启动（推荐）

在项目根目录右键，选择"在终端中打开"，然后执行：

```powershell
.\清理并启动.ps1
```

这个脚本会自动：

1. ✅ 检查并清理端口占用
2. ✅ 启动后端服务（端口 3001）
3. ✅ 启动前端服务（端口 5173）
4. ✅ 在独立窗口显示每个服务的日志

## 📋 手动启动

### 启动后端

```powershell
cd backend
npm run dev
```

### 启动前端

```powershell
cd frontend
npm run dev
```

## 🌐 访问地址

启动完成后，可以访问：

- **前台首页**: http://localhost:5173
- **管理后台**: http://localhost:5173/admin/login
- **后端 API**: http://localhost:3001/api

## 🔑 默认管理员账号

- **用户名**: admin
- **密码**: admin123

## ⚠️ 常见问题

### 问题 1：端口被占用

**现象**：启动时提示 `EADDRINUSE` 错误

**解决方案**：

1. 使用一键启动脚本（会自动清理）
2. 或手动清理：

   ```powershell
   # 查找占用端口的进程
   netstat -ano | findstr :3001
   netstat -ano | findstr :5173

   # 停止进程（替换 <PID> 为实际进程ID）
   taskkill /F /PID <PID>
   ```

### 问题 2：前端构建错误

**现象**：Vite 报错找不到文件

**解决方案**：

1. 清除缓存并重启：
   ```powershell
   cd frontend
   rm -r node_modules/.vite
   npm run dev
   ```

### 问题 3：无法连接后端 API

**现象**：前端请求失败

**检查步骤**：

1. 确认后端服务已启动（查看控制台输出）
2. 确认端口配置一致：
   - 后端: `backend/.env.development` 中的 `PORT=3001`
   - 前端: `frontend/.env.development` 中的 `VITE_API_BASE_URL=http://localhost:3001/api`

### 问题 4：数据库连接失败

**现象**：后端启动报错 database connection failed

**解决方案**：

1. 确认 PostgreSQL 服务已启动
2. 检查 `backend/.env.development` 中的数据库配置：
   ```
   DB_HOST=localhost
   DB_PORT=5432
   DB_NAME=pet_web
   DB_USER=postgres
   DB_PASSWORD=your_password
   ```
3. 初始化数据库（如果首次运行）：
   ```powershell
   cd backend
   npm run db:init
   ```

## 🛠️ 开发工具

### 后端开发

- 查看日志：后端服务窗口会实时显示
- 重启服务：在后端服务窗口按 `rs` 回车
- 完全停止：按 `Ctrl+C`

### 前端开发

- 热重载：修改代码后自动刷新
- 完全停止：按 `Ctrl+C`

### 数据库管理

```powershell
cd backend

# 初始化数据库
npm run db:init

# 强制重置数据库（⚠️ 会删除所有数据）
npm run db:init:force

# 创建管理员账号
npm run create:admin
```

## 📦 依赖安装

如果是首次克隆项目，需要先安装依赖：

```powershell
# 后端依赖
cd backend
npm install

# 前端依赖
cd ../frontend
npm install
```

## 🔧 配置说明

### 后端配置文件

- `backend/.env.development` - 开发环境配置
- `backend/.env.production` - 生产环境配置

### 前端配置文件

- `frontend/.env.development` - 开发环境配置
- `frontend/.env.production` - 生产环境配置

## 📚 更多文档

- [后端启动说明](backend/启动说明.md)
- [后端快速开始](backend/GETTING_STARTED.md)
- [API 文档](docs/)

## 💡 提示

1. 推荐使用一键启动脚本，避免手动操作
2. 开发时保持两个服务窗口都打开
3. 修改环境变量后需要重启服务
4. 定期查看服务日志，及时发现问题
